
@{
    ViewData["Title"] = "Kết quả";
}

<div class="card">
    <div class="card-header bg-info" style="padding-bottom: 0px; padding-top: 5px">
        <h5 class="card-title text-white">
            Danh sách bệnh nhân có kết quả Xét nghiệm Test nhanh
        </h5>
    </div>

    <div class="card-body">
        <!-- tab -->
        <ul class="nav nav-pills">
            <li class="nav-item">
                <a href="#tab1" data-toggle="tab" class="nav-link active">Chưa in kết quả</a>
            </li>

            <li class="nav-item">
                <a href="#tab2" data-toggle="tab" class="nav-link">Đã in kết quả</a>
            </li>

            <li class="nav-item">
                <a href="#tab3" data-toggle="tab" class="nav-link">Báo cáo</a>
            </li>
        </ul>
    </div>

    <div class="card-body">
        <div class="tab-content">
            <div class="tab-pane container-fluid active" id="tab1">
                <div id="divDanhSachKqChuaIn"></div>
            </div>

            <div class="tab-pane container-fluid" id="tab2">
                <div class="row">
                    <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4">
                        <div class="form-group">
                            <div class="form-inline">
                                <span>Từ ngày: </span>
                                <input type="date" id="dtTuNgayTab2" class="form-control ml-2" value="@DateTime.Now.ToString("yyyy-MM-dd")" />
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4">
                        <div class="form-group">
                            <div class="form-inline">
                                <span>Đến ngày: </span>
                                <input type="date" id="dtDenNgayTab2" class="form-control ml-2" value="@DateTime.Now.ToString("yyyy-MM-dd")" />
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4">
                        <button id="btnLayBaoCaoTab2" type="button" class="btn btn-primary">Lấy dữ liệu</button>

                    </div>
                </div>

                <hr />

                <div class="row">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                        <div id="divDanhSachKqDaIn"></div>
                    </div>
                </div>




            </div>

            <div class="tab-pane container-fluid" id="tab3">
                <div class="row">
                    <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4">
                        <div class="form-group">
                            <div class="form-inline">
                                <span>Từ ngày: </span>
                                <input type="date" id="dtTuNgay" class="form-control ml-2" value="@DateTime.Now.ToString("yyyy-MM-dd")" />
                            </div>
                        </div>                       
                    </div>
                    <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4">
                        <div class="form-group">
                            <div class="form-inline">
                                <span>Đến ngày: </span>
                                <input type="date" id="dtDenNgay" class="form-control ml-2" value="@DateTime.Now.ToString("yyyy-MM-dd")" />
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4">
                        <button id="btnLayBaoCao" type="button" class="btn btn-primary">Lấy dữ liệu</button>

                    </div>
                </div>

                <hr />

                <div class="row">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                        <div id="divBaoCao"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts{
    <script>


        function GetListKetQuaChuaIn() {
                $.ajax({
                    type: "GET",
                    url: "/Home/GetListKetQuaChuaIn",
                    //data: JSON.stringify(objArr),
                    //data: { 'noiDung': noiDung },
                    //contentType: "application/json; charset=utf-8",
                    dataType: "text",
                    success: function (responses) {
                        if (responses === 0 || responses === "0") {
                            swal.fire("Không lấy được thông tin");
                        } else {
                            $("#divDanhSachKqChuaIn").html(responses);
                        }
                    },
                    failure: function (response) {
                        alert("failure: GetListKetQuaChuaIn Home" + response.responseText);
                    },
                    error: function (response) {
                        alert("error: GetListKetQuaChuaIn Home" + response.responseText);
                    }
                });
        }

        function GetListKetQuaDaIn() {
            var tuNgay = $("#dtTuNgayTab2").val();
            var denNgay = $("#dtDenNgayTab2").val();


            $.ajax({
                type: "GET",
                url: "/Home/GetListKetQuaDaIn",
                //data: JSON.stringify(objArr),
                data: { 'tuNgay': tuNgay, 'denNgay': denNgay },
                //contentType: "application/json; charset=utf-8",
                dataType: "text",
                success: function (responses) {
                    if (responses === 0 || responses === "0") {
                        swal.fire("Không lấy được thông tin");
                    } else {
                        $("#divDanhSachKqDaIn").html(responses);
                    }
                },
                failure: function (response) {
                    alert("failure: GetListKetQuaDaIn KetQua" + response.responseText);
                },
                error: function (response) {
                    alert("error: GetListKetQuaDaIn KetQua" + response.responseText);
                }
            });
        }

        function LayBaoCao() {
            var tuNgay = $("#dtTuNgay").val();
            var denNgay = $("#dtDenNgay").val();


            $.ajax({
                type: "GET",
                url: "/Home/LayBaoCao",
                //data: JSON.stringify(objArr),
                data: { 'tuNgay': tuNgay, 'denNgay': denNgay },
                //contentType: "application/json; charset=utf-8",
                dataType: "text",
                success: function (responses) {
                    if (responses === 0 || responses === "0") {
                        swal.fire("Không lấy được thông tin");
                    } else {
                        $("#divBaoCao").html(responses);
                    }
                },
                failure: function (response) {
                    alert("failure: BaoCao KetQua" + response.responseText);
                },
                error: function (response) {
                    alert("error: BaoCao KetQua" + response.responseText);
                }
            });
        }

        

        $(document).ready(function () {
            //setTimeout(function () {
            //    window.location.reload();

            //}, 10000);

            GetListKetQuaChuaIn();
            
            $("#btnLayBaoCao").click(function () {
                LayBaoCao();
            });

            $("#btnLayBaoCaoTab2").click(function () {
                GetListKetQuaDaIn();
            });
        });
    </script>
}

